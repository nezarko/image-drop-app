"use client";

import { useEffect, useLayoutEffect, useMemo, useRef, useState } from "react";
import { lerp, svgFill } from "../Common/svgFill";

const options = {
  viewBox: [1045, 194],
  d: "M16.0801 173.66V3.66984L73.6801 173.66V4.45984M184.49 3.66984L132.23 3.85984V175.05H184.49M132.23 96.9598H181M380.76 3.85984H331.23V175.05H383.49M331.23 93.9598H381M213.23 3.83984L236.6 174.55L259.38 174.66L279.24 3.66984M422.28 175.66V5.83984C422.28 5.83984 476.23 9.83985 477.23 56.8398C476.23 93.8398 465.294 89.8308 465.294 89.8308M465.294 89.8308C491.489 123.562 476.23 124.84 477.6 175.66M465.294 89.8308H441.686M569.36 175.66L574.53 140.58L586.85 4.66984H612.02L630.89 175.66M625.32 140.25H574.53M796.36 175.66L799.53 140.58L810.85 4.66984H838.02L855.89 175.66M851.32 140.25H799.53M737.99 66.7698C739.23 33.8398 737.23 1.83984 710.23 1.83984C678.23 1.83984 678.23 50.9998 678.23 96.8398C678.23 142.68 678.23 175.84 711.23 175.84C733.17 175.84 741.23 162.74 741.23 137.84L742.23 103.84H714.23M741.23 175.84V144.48M908.03 5.66984V175.66M971.28 175.44V5.45984L1025.88 175.44L1028.88 5.24984",
  strokeWidth: 30,
  itemsPerRow: 5,
  radius: 7,
};

export function NeverAgain({signed}) {
  const svg = useMemo(() => svgFill(options), []);
  const [f, setF] = useState([]);
  
  
  useEffect(() => {
    console.log("Nwve",signed)
      f.push(svg.fill(signed, f));
    setF(f);
  }, [signed])


  const [filled, setFilled] = useState(() => {
    const data = [];

    for (let i = 0; i < 1000; i++) {
      data.push(svg.fill(i, data));
    }
    return data;
  });

  const width = 1200;
  const ref = useRef();
  const scale = width / options.viewBox[0];
  return (
    <>
      <div
        style={{
          position: "relative",
        }}
      >
        <svg
          ref={ref}
          xmlns="http://www.w3.org/2000/svg"
          width={svg.options.viewBox[0]}
          fill="none"
          viewBox={`0 0 ${svg.options.viewBox[0]} ${svg.options.viewBox[1]}`}
          style={{
            width,
            scale,
            transformOrigin: "0 0 ",
          }}
        >
          <path
            d="M91.8 4.34961V189.33H55.76L34.37 105.24V189.33H0V4.34961H34.38L57.43 87.6396V4.34961H91.81H91.8Z"
            fill="#333333"
          />
          <path
            d="M114.3 4.34961H182.85V41.3696H155.41V76.4496H181.09V111.64H155.41V152.32H185.59V189.34H114.3V4.35962V4.34961Z"
            fill="#333333"
          />
          <path
            d="M301.16 4.34961L280.24 189.33H217.79L194.04 4.34961H237.4C242.44 55.3096 246.04 98.4196 248.19 133.69C250.31 98.0396 252.57 66.3996 254.95 38.7496L257.8 4.34961H301.16Z"
            fill="#333333"
          />
          <path
            d="M314.09 4.34961H382.64V41.3696H355.2V76.4496H380.88V111.64H355.2V152.32H385.38V189.34H314.09V4.35962V4.34961Z"
            fill="#333333"
          />
          <path
            d="M403.2 4.34961H432.3C451.7 4.34961 464.83 5.22961 471.7 6.97961C478.57 8.72961 484.17 13.2096 488.5 20.4096C492.83 27.6096 494.99 39.0896 494.99 54.8596C494.99 69.2596 493.46 78.9296 490.4 83.8796C487.34 88.8296 481.32 91.7996 472.33 92.7896C480.47 95.1496 485.94 98.3097 488.74 102.27C491.54 106.23 493.28 109.87 493.96 113.18C494.64 116.49 494.99 125.62 494.99 140.54V189.33H456.81V127.86C456.81 117.96 456.14 111.83 454.81 109.46C453.48 107.1 449.98 105.92 444.31 105.92V189.33H403.2V4.34961ZM444.31 35.9996V77.1296C448.93 77.1296 452.17 76.3897 454.03 74.8997C455.89 73.4197 456.81 68.5996 456.81 60.4496V50.2797C456.81 44.4197 455.91 40.5696 454.12 38.7396C452.33 36.9096 449.06 35.9996 444.31 35.9996Z"
            fill="#333333"
          />
          <path
            d="M629.24 4.34961L652.75 189.33H610.73L608.52 156.08H593.81L591.34 189.33H548.84L569.81 4.34961H629.23H629.24ZM607.45 123.29C605.37 102.34 603.28 76.4397 601.19 45.5897C597 81.0097 594.37 106.91 593.3 123.29H607.45Z"
            fill="#333333"
          />
          <path
            d="M760.07 72.4498H718.96V55.6498C718.96 45.0598 718.57 38.4398 717.79 35.7698C717.01 33.0998 715.15 31.7698 712.22 31.7698C709.68 31.7698 707.96 32.9098 707.04 35.1998C706.13 37.4898 705.67 43.3497 705.67 52.7997V141.58C705.67 149.88 706.12 155.35 707.04 157.98C707.95 160.61 709.77 161.92 712.51 161.92C715.5 161.92 717.54 160.43 718.61 157.46C719.68 154.49 720.22 148.7 720.22 140.09V118.15H711.92V90.0397H760.06V189.33H734.22L730.42 176.08C727.62 181.79 724.08 186.08 719.82 188.93C715.55 191.79 710.52 193.22 704.72 193.22C697.81 193.22 691.35 191.26 685.32 187.34C679.29 183.42 674.72 178.56 671.59 172.77C668.46 166.98 666.51 160.91 665.73 154.55C664.95 148.19 664.56 138.65 664.56 125.93V70.9697C664.56 53.2997 665.37 40.4597 667 32.4697C668.63 24.4697 673.3 17.1397 681.01 10.4697C688.72 3.80973 698.7 0.469727 710.94 0.469727C723.18 0.469727 732.98 3.36978 740.92 9.14978C748.86 14.9398 754.04 21.8198 756.45 29.7698C758.86 37.7298 760.06 49.2898 760.06 64.4498V72.4498H760.07Z"
            fill="#333333"
          />
          <path
            d="M853.05 4.34961L876.56 189.33H834.54L832.33 156.08H817.62L815.15 189.33H772.65L793.62 4.34961H853.04H853.05ZM831.26 123.29C829.18 102.34 827.09 76.4397 825 45.5897C820.81 81.0097 818.18 106.91 817.11 123.29H831.26Z"
            fill="#333333"
          />
          <path
            d="M930.66 4.34961V189.33H889.55V4.34961H930.66Z"
            fill="#333333"
          />
          <path
            d="M1044.96 4.34961V189.33H1008.92L987.53 105.24V189.33H953.15V4.34961H987.53L1010.58 87.6396V4.34961H1044.96Z"
            fill="#333333"
          />
          {/* {filled.map((point, index) => (
            <g key={index}>
              <line
                x1={point.tangent.start.x}
                y1={point.tangent.start.y}
                x2={point.tangent.end.x}
                y2={point.tangent.end.y}
                stroke="blue"
                strokeWidth={2}
                style={{
                  zIndex: 1000,
                  position: "relative",
                }}
              />
              <circle
                cx={lerp(point.tangent.start, point.tangent.end, 0.5).x}
                cy={lerp(point.tangent.start, point.tangent.end, 0.5).y}
                r={options.radius}
                fill="blue"
              />
            </g>
          ))}

          <path strokeWidth={1} stroke="yellow" d={options.d} />
          {filled.map((point, index) => (
            <circle
              key={index}
              cx={point.x}
              cy={point.y}
              r={1}
              fill="yellow"
              style={
                {
                  // display: "none",
                }
              }
            />
          ))}
            */}
        </svg>

        {f.length&& f.map((point, index) => (
          <Flower
            key={index}
            style={{
              position: "absolute",
              // width: 12,
              left: (point.x - 10) * scale,
              top: (point.y - 15) * scale,
              // display: "none",
              transform: `scale(${scale / 2})`,
              transformOrigin: "0 0",
              zIndex: point.zIndex,
            }}
          />
        ))}
      </div>
      {/* Some empty space for testing */}
      <div
        style={{
          height: 200,
        }}
      />
    </>
  );
}

const Flower = (props) => {
  return (
    <svg
      {...props}
      width="39"
      height="109"
      viewBox="0 0 39 109"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M21.87 73.0996C21.87 70.1596 23.85 68.4996 24.95 65.8896C26.23 62.8396 27.1 59.6204 28.59 56.6504C29.99 53.8504 31.85 51.3702 33.46 48.7002C34.72 46.6102 36.65 44.9395 37.71 42.7695C36.93 44.3695 37.05 46.1899 36.9 47.9199C36.73 49.9299 36.44 51.9297 36.22 53.9297C35.92 56.5497 35.27 59.44 33.89 61.71C32.23 64.44 29.61 67.0598 26.65 68.3398C25.72 68.7398 24.7 69.0397 23.92 69.7197C23.19 70.3597 21.88 72.1296 21.88 73.0996H21.87Z"
        fill="#8CC63F"
      />
      <path
        d="M23.3 60.8398C22.86 58.9398 21.19 58.42 19.62 58C17.74 57.49 16.29 56.42 14.79 55.21C12.38 53.26 10.45 50.73 9.09003 47.96C7.42003 44.55 5.93999 40.8001 4.92999 37.1201C4.23999 34.6201 2.50998 31.2498 0.539978 29.5098C4.00998 32.5698 7.35001 35.78 11.14 38.46C13.62 40.21 15.96 42.91 17.81 45.25C20.42 48.54 21.85 51.9095 22.53 56.0195C23 58.8995 23.74 61.3098 23.35 64.2598"
        fill="#8CC63F"
      />
      <path
        d="M23.61 107.98C19.72 99.1705 20.21 87.2399 21.6 76.6699C22.97 66.2999 24.89 56.1202 24.11 45.4102C23.45 36.4102 21.1 27.3698 17.98 19.8398"
        stroke="white"
        stroke-width="1.5"
        stroke-miterlimit="10"
      />
      <path
        d="M23.6 18.5191C24.24 14.8291 27.23 11.8199 30.7 10.5299C32.22 9.95989 33.95 9.71942 35.47 10.2994C36.99 10.8794 38.21 12.4297 38.02 14.0397C37.9 15.0297 37.29 15.9197 36.51 16.5397C35.73 17.1597 34.79 17.5698 33.86 17.9098C30.63 19.1098 27.2 19.7592 23.76 19.8492"
        fill="white"
      />
      <path
        d="M20.98 14.5896C19.76 11.9096 19.44 8.81991 20.11 5.94991C20.51 4.19991 21.33 2.45983 22.76 1.36983C24.19 0.279832 26.34 2.75373e-05 27.79 1.07003C28.86 1.85003 29.39 3.20999 29.42 4.52999C29.45 5.84999 29.02 7.13956 28.48 8.33956C27.79 9.84956 26.9 11.2598 25.96 12.6198C24.94 14.0998 23.78 15.59 22.12 16.28"
        fill="white"
      />
      <path
        d="M17.56 17.8899C13.76 15.9699 10.07 13.4607 8.4 9.44067C7.91 8.26067 7.52995 6.9902 7.59995 5.7102C7.67995 4.4302 8.29 3.13047 9.4 2.49047C10.61 1.80047 12.19 2.02047 13.39 2.74047C14.59 3.46047 15.4599 4.61051 16.2199 5.78051C18.6299 9.51051 20.55 13.3604 18.95 17.7004"
        fill="white"
      />
      <path
        d="M15.3 21.0396C12.69 22.4096 9.61998 22.8895 6.71998 22.3795C4.94998 22.0695 3.17 21.35 2 19.98C0.830005 18.61 0.439988 16.4793 1.41999 14.9693C2.13999 13.8593 3.47003 13.25 4.78003 13.15C6.09003 13.05 7.41002 13.3992 8.64002 13.8892C10.18 14.4992 11.64 15.3095 13.05 16.1695C14.58 17.1095 16.14 18.1891 16.91 19.8091"
        fill="white"
      />
      <path
        d="M19.63 24.1201C22.8277 24.1201 25.42 21.5278 25.42 18.3301C25.42 15.1323 22.8277 12.54 19.63 12.54C16.4323 12.54 13.84 15.1323 13.84 18.3301C13.84 21.5278 16.4323 24.1201 19.63 24.1201Z"
        fill="#EC1C24"
      />
    </svg>
  );
};
